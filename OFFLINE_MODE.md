# ๐ ูุธุงู ุงูุนูู ุจุฏูู ุฅูุชุฑูุช (Offline Mode)

## โจ ุงููููุฒุงุช

### 1. **ุงูุนูู ุงููุงูู ุจุฏูู ุฅูุชุฑูุช**

- โ ุฅุถุงูุฉ ุนููุงุก ุฌุฏุฏ
- โ ุฅุถุงูุฉ ูุนุฏุงุช ุฌุฏูุฏุฉ
- โ ุฅูุดุงุก ุนููุฏ ุฅูุฌุงุฑ
- โ ุฅุฑุฌุงุน ูุนุฏุงุช
- โ ุนุฑุถ ุฌููุน ุงูุจูุงูุงุช ุงููุญููุธุฉ ูุญููุงู

### 2. **ุงููุฒุงููุฉ ุงูุชููุงุฆูุฉ**

- ๐ ูุฒุงููุฉ ุชููุงุฆูุฉ ุนูุฏ ุงูุนูุฏุฉ ููุฅูุชุฑูุช
- ๐ ูุฒุงููุฉ ุฏูุฑูุฉ ูู 5 ุฏูุงุฆู
- ๐ ุฅุนุงุฏุฉ ูุญุงููุฉ ุชููุงุฆูุฉ ููุนูููุงุช ุงููุงุดูุฉ (ุญุชู 3 ูุญุงููุงุช)
- ๐ ุชุฑุชูุจ ุฐูู ููุนูููุงุช (ุฅุถุงูุฉ โ ุชุญุฏูุซ โ ุญุฐู)

### 3. **ูุคุดุฑุงุช ุจุตุฑูุฉ**

- ๐ข ูุคุดุฑ ุงูุงุชุตุงู (ูุชุตู/ุบูุฑ ูุชุตู)
- ๐ ุนุฏุฏ ุงูุนูููุงุช ูู ุงูุงูุชุธุงุฑ
- โฐ ููุช ุขุฎุฑ ูุฒุงููุฉ
- ๐ ุฒุฑ ุงููุฒุงููุฉ ุงููุฏููุฉ

## ๐๏ธ ููููุฉ ุงูุนูู

### ุชุฎุฒูู ูุญูู (IndexedDB)

ูุชู ุญูุธ ุฌููุน ุงูุจูุงูุงุช ูุญููุงู ูู ูุชุตูุญ ุงููุณุชุฎุฏู ุจุงุณุชุฎุฏุงู IndexedDB:

```typescript
// ุงูุฌุฏุงูู ุงููุญููุฉ
-customers - // ุงูุนููุงุก
  equipment - // ุงููุนุฏุงุช
  rentals - // ุงูุฅูุฌุงุฑุงุช
  rental_items - // ุนูุงุตุฑ ุงูุฅูุฌุงุฑ
  sync_queue; // ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุนูููุงุช
```

### ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุนูููุงุช (Sync Queue)

ุนูุฏ ุงูุนูู ุจุฏูู ุฅูุชุฑูุชุ ูุชู ุฅุถุงูุฉ ูู ุนูููุฉ ุฅูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ:

```typescript
{
  id: "uuid",
  table: "customers",
  operation: "insert",
  data: { /* ุจูุงูุงุช ุงูุนูููุฉ */ },
  timestamp: 1234567890,
  retries: 0
}
```

### ุนูููุฉ ุงููุฒุงููุฉ

#### 1. **ุนูุฏ ุงูุนูุฏุฉ ููุฅูุชุฑูุช:**

- โฑ๏ธ ุงูุชุธุงุฑ 2 ุซุงููุฉ ููุชุฃูุฏ ูู ุงุณุชูุฑุงุฑ ุงูุงุชุตุงู
- ๐ค ูุนุงูุฌุฉ ุฌููุน ุงูุนูููุงุช ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
- โ ุญุฐู ุงูุนูููุงุช ุงููุงุฌุญุฉ ูู ุงููุงุฆูุฉ
- โ ุฅุนุงุฏุฉ ูุญุงููุฉ ุงูุนูููุงุช ุงููุงุดูุฉ
- ๐ฅ ุณุญุจ ุฃุญุฏุซ ุงูุจูุงูุงุช ูู ุงูุณูุฑูุฑ

#### 2. **ูุฒุงููุฉ ุฏูุฑูุฉ:**

- ูู 5 ุฏูุงุฆูุ ูุชู ุงูุชุญูู ูู ูุฌูุฏ ุนูููุงุช ูู ุงูุงูุชุธุงุฑ
- ุฅุฐุง ูุงู ููุงู ุนูููุงุชุ ูุชู ูุฒุงููุชูุง ุชููุงุฆูุงู

#### 3. **ูุฒุงููุฉ ูุฏููุฉ:**

- ูููู ูููุณุชุฎุฏู ุงูุถุบุท ุนูู ุฒุฑ "ูุฒุงููุฉ ุงูุขู"
- ูููุฏ ุนูุฏ ุงูุญุงุฌุฉ ููุฒุงููุฉ ููุฑูุฉ

## ๐ ุงุณุชุฎุฏุงู ุงููุธุงู

### ูููุทูุฑูู

#### ุงุณุชุฎุฏุงู ุงูู Hooks ุงูุฌุงูุฒุฉ:

```typescript
import {
  useOfflineQuery,
  useOfflineMutation,
} from "@/lib/offline/useOfflineData";

// ูุฑุงุกุฉ ุงูุจูุงูุงุช
const { data: customers } = useOfflineQuery({
  queryKey: ["customers"],
  table: "customers",
  orderBy: { column: "created_at", ascending: false },
});

// ูุชุงุจุฉ ุงูุจูุงูุงุช
const createCustomer = useOfflineMutation({
  table: "customers",
  operation: "insert",
  onSuccess: () => {
    toast.success("ุชู ุฅุถุงูุฉ ุงูุนููู");
  },
});

// ุงุณุชุฎุฏุงู
createCustomer.mutate({
  full_name: "ูุญูุฏ",
  phone: "0501234567",
  // ...
});
```

### ูููุณุชุฎุฏููู

#### 1. **ุงูุนูู ุจุฏูู ุฅูุชุฑูุช:**

- ุงุณุชุฎุฏู ุงูุชุทุจูู ุจุดูู ุทุจูุนู
- ุณุชุฑู ุฑุณุงูุฉ "ุชู ุญูุธ ุงูุนูููุฉ ูุญููุงู" ุนูุฏ ุฅุถุงูุฉ ุฃู ุชุนุฏูู ุงูุจูุงูุงุช
- ุฌููุน ุงูุจูุงูุงุช ุณุชููู ูุชุงุญุฉ ููุนุฑุถ ูุงูุชุนุฏูู

#### 2. **ุงูุนูุฏุฉ ููุฅูุชุฑูุช:**

- ุณุชุธูุฑ ุฑุณุงูุฉ ุชููุงุฆูุฉ "ุฌุงุฑู ุงููุฒุงููุฉ..."
- ุจุนุฏ ุงูุชูุงุก ุงููุฒุงููุฉุ ุณุชุธูุฑ ุฑุณุงูุฉ "ุชู ูุฒุงููุฉ X ุนูููุฉ ุจูุฌุงุญ"
- ุฌููุน ุจูุงูุงุชู ุงูุขู ูุญููุธุฉ ูู ุงูุณูุฑูุฑ

#### 3. **ุงููุฒุงููุฉ ุงููุฏููุฉ:**

- ุงูุธุฑ ูููุฑุจุน ูู ุฃุณูู ูุณุงุฑ ุงูุดุงุดุฉ
- ุฅุฐุง ูุงู ููุงู ุนูููุงุช ูู ุงูุงูุชุธุงุฑุ ุงุถุบุท "ูุฒุงููุฉ ุงูุขู"

## ๐ง ุงูุชููุฆุฉ

### ูุชุทูุจุงุช ุงููุชุตูุญ

- IndexedDB support (ุฌููุน ุงููุชุตูุญุงุช ุงูุญุฏูุซุฉ)
- Service Worker support (ุงุฎุชูุงุฑู ููุชุฎุฒูู ุงููุคูุช)

### ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑูุฉ)

#### ุชุฎุตูุต ูุฏุฉ ุงููุฒุงููุฉ:

```typescript
// ูู SyncManager.tsx
const syncInterval = 5 * 60 * 1000; // 5 ุฏูุงุฆู (ุงูุชุฑุงุถู)
// ูููู ุชุบููุฑูุง ุญุณุจ ุงูุญุงุฌุฉ
```

#### ุชุฎุตูุต ุนุฏุฏ ุงููุญุงููุงุช:

```typescript
// ูู sync.ts
const MAX_RETRIES = 3; // 3 ูุญุงููุงุช (ุงูุชุฑุงุถู)
```

## ๐ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### ุงูุนูููุงุช ุงููุงุดูุฉ

- ูุชู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุชููุงุฆูุงู 3 ูุฑุงุช
- ุจุนุฏ 3 ูุญุงููุงุช ูุงุดูุฉุ ูุชู ุญุฐู ุงูุนูููุฉ ูู ุงููุงุฆูุฉ
- ูุธูุฑ ุฅุดุนุงุฑ ูููุณุชุฎุฏู

### ุชุนุงุฑุถุงุช ุงูุจูุงูุงุช

- ูุชู ุงุณุชุฎุฏุงู timestamp ูุญู ุงูุชุนุงุฑุถุงุช
- ุงูุจูุงูุงุช ุงูุฃุญุฏุซ ุฏุงุฆูุงู ูู ุงูุชู ุชูุญูุธ
- ูู ุญุงูุฉ ุงูุชุนุงุฑุถุ ูุชู ุฅุนุทุงุก ุงูุฃููููุฉ ูุจูุงูุงุช ุงูุณูุฑูุฑ

## ๐ ุงููุฑุงูุจุฉ

### Console Logs

ุฌููุน ุนูููุงุช ุงููุฒุงููุฉ ูุณุฌูุฉ ูู ุงูู console:

```
Starting sync of 5 items
Successfully synced 5 items, pulling latest data...
Sync complete
```

### ูุคุดุฑ ุงูุญุงูุฉ

ุงููุฑุจุน ูู ุฃุณูู ูุณุงุฑ ุงูุดุงุดุฉ ูุนุฑุถ:

- ๐ข ุญุงูุฉ ุงูุงุชุตุงู
- ๐ ุนุฏุฏ ุงูุนูููุงุช ูู ุงูุงูุชุธุงุฑ
- โฐ ููุช ุขุฎุฑ ูุฒุงููุฉ

## ๐ ุฃูุถู ุงูููุงุฑุณุงุช

1. **ุชุฃูุฏ ูู ุงููุฒุงููุฉ ุงูุฏูุฑูุฉ**

   - ุงุชุฑู ุงูุชุทุจูู ููุชูุญุงู ููุฏุฉ ูุงููุฉ ูุฅุชูุงู ุงููุฒุงููุฉ

2. **ุงุณุชุฎุฏู ุงููุฒุงููุฉ ุงููุฏููุฉ**

   - ุนูุฏ ุฅููุงุก ุฌูุณุฉ ุงูุนููุ ุชุฃูุฏ ูู ูุฒุงููุฉ ุฌููุน ุงูุจูุงูุงุช

3. **ูุง ุชุบูู ุงููุชุตูุญ ูุจุงุดุฑุฉ**

   - ุงูุชุธุฑ ุญุชู ุชูุชูู ุงููุฒุงููุฉ ูุจู ุฅุบูุงู ุงููุชุตูุญ

4. **ุฑุงูุจ ูุคุดุฑ ุงูุญุงูุฉ**
   - ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุนูููุงุช ูู ุงูุงูุชุธุงุฑ ูุจู ุงูุฎุฑูุฌ

## ๐ ุงูุฃูุงู

- โ ุฌููุน ุงูุจูุงูุงุช ุงููุญููุฉ ูุดูุฑุฉ ูู ุงููุชุตูุญ
- โ ูุง ูุชู ูุดุงุฑูุฉ ุงูุจูุงูุงุช ุจูู ุงููุณุชุฎุฏููู
- โ ุงูุจูุงูุงุช ุชูุญุฐู ุนูุฏ ุชุณุฌูู ุงูุฎุฑูุฌ (ุงุฎุชูุงุฑู)

## ๐ฑ ุฏุนู ุงูุฃุฌูุฒุฉ

- โ Desktop (Windows, Mac, Linux)
- โ Mobile (iOS, Android)
- โ Tablet (iPad, Android Tablets)

## ๐ฏ ุงูุญุงูุงุช ุงููุฏุนููุฉ

### โ ูุฏุนูู

- ุงูุนูู ุจุฏูู ุฅูุชุฑูุช ููุชุฑุงุช ุทูููุฉ
- ุงูุนูุฏุฉ ููุฅูุชุฑูุช ูุงููุฒุงููุฉ
- ูุทุน ุงูุงุชุตุงู ุงูููุงุฌุฆ
- ุงุชุตุงู ุถุนูู/ูุชูุทุน

### โ๏ธ ูุญุฏูุฏ

- ุงูุชุนุฏูู ูู ุฃูุซุฑ ูู ุฌูุงุฒ ูู ููุณ ุงูููุช (ูุฏ ุชุญุฏุซ ุชุนุงุฑุถุงุช)
- ุงูุนูููุงุช ุงูุถุฎูุฉ ุฌุฏุงู (ุขูุงู ุงูุณุฌูุงุช)

### โ ุบูุฑ ูุฏุนูู

- ุงููุฒุงููุฉ ุนุจุฑ ุฃุฌูุฒุฉ ูุชุนุฏุฏุฉ ุจุฏูู ุงุชุตุงู
- ุงูุนูู ุงูุฌูุงุนู ุนูู ููุณ ุงูุณุฌู ุจุฏูู ุงุชุตุงู
